/*CONSULTAS*/


/*CANTIDAD DE CLIENTES QUE LOGRARON 3 RUTINAS DE ENTRENAMIENTO*/

select 
	RUTINA.CEDULA_CLIENTE,
	COUNT (NUMERO_RUTINA)AS CANTIDAD_DE_RUTINAS_HECHAS
	FROM RUTINA  
	GROUP BY 1 HAVING COUNT (NUMERO_RUTINA)>=3

/*TOP DE VISITAS DE CLIENTES EN FORMA DESCENDENTE*/
select
	cliente.nombres_cliente, cliente.apellidos_cliente, count (asistencia.id_asistencia)as total_asistencia
	from cliente
	inner join asistencia on cliente.cedula_cliente  = asistencia.cedula_cliente
	group by cliente.nombres_cliente, cliente.apellidos_cliente order by total_aistencia desc


/*PRODUCTOS COMPRADOS POR CADA CLIENTE*/
		select
	cliente.nombres_cliente, cliente.apellidos_cliente, count (venta.id_venta)as productos_comprados
	from cliente
	inner join venta  on cliente.cedula_cliente  = venta.cedula_cliente
	group by cliente.nombres_cliente, cliente.apellidos_cliente order by productos_comprados desc
	
/*CANTIDAD DE RUTINAS DADAS POR CADA ENTRENADOR*/
	select rutina.cedula_empleado,
	sum (rutina.numero_rutina) as total_rutinas,
	empleado.nombres_empleado,
	empleado.apellidos_empleado
	from rutina
	inner join empleado on empleado.cedula_empleado = rutina.cedula_empleado
	group by rutina.cedula_empleado, empleado.nombres_empleado, empleado.apellidos_empleado;
